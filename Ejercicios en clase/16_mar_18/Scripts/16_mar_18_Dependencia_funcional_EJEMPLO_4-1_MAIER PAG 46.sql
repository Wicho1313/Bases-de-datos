REM PROBAR EL AXIOMA 2 DE LA PAG 46 LIBRO MAIER
REM ESTE AXIOMA TRATA DEL AUMENTO DEL LADO IZQUIERDO
REM DE LA DEPENDENCIA FUNCIONAL
/* PROBEMOS SI SE SATISFACEN LAS SIGUIENTES DEPENDENCIAS FUNCIONALES
FD A-->B
   AB-->B,AC-->B, AD-->B, ABC--->B,
   ABD-->B, ACD-->B, ABCD-->B.
CONSIDERE LA TABLA R1 CON LAS CUATRO TUPLAS EJEMPLO
*/
spool D:\ESCOM\bases\16_mar_18\DF_MAIER.txt
SET FLUSH OFF
SET ECHO OFF
SET TERMOUT OFF
DROP TABLE R1;

CREATE TABLE R1(
A VARCHAR2(2),
B VARCHAR2(2),
C VARCHAR2(2),
D VARCHAR2(2)
);

INSERT INTO R1 VALUES('a1','b1','c1','d1');
INSERT INTO R1 VALUES('a2','b2','c1','d1');
INSERT INTO R1 VALUES('a1','b1','c1','d2');
INSERT INTO R1 VALUES('a4','b3','c2','d3');

select * from r1;

prompt probemos la primera dependencia funcional
prompt FD A-->B

SELECT A,'-->',B
FROM R1 
ORDER BY 1;

REM CADA VALOR DIFERENTE DE B ES DETERMINADO
REM DE FORMA UNICA POR UN VALOR DE A
/* CONSTRUYAMOS UNA TABLA AUXILIAR PARA FACILITAR
LA VISUALIZACION DE LA DEPENDENCIA FUNCIONAL
EL LADO IZQ DE LA DEP Y EL LADO DERECHO
*/

REM OBTIENE LA DF AB-->B

DROP TABLE TEMP_DF;

CREATE TABLE TEMP_DF(
DF_IZQ VARCHAR2(15),
DF_DER VARCHAR2(15)
);

PROMPT INSERTAMOS LOS VALORES DEL LADO IZQ Y DERECHO DE LA DF

INSERT INTO TEMP_DF (DF_IZQ, DF_DER)
SELECT CONCAT(CONCAT(A,','),B),B
FROM R1;

PROMPT VEMOS SI SATISFACE AB-->B
SELECT DF_IZQ " AB --> ",
DF_DER "B"
FROM TEMP_DF ORDER BY DF_IZQ;

REM PROBEMOS LA DF AC-->B
DELETE FROM TEMP_DF;
SELECT * FROM TEMP_DF;

INSERT INTO TEMP_DF (DF_IZQ, DF_DER)
SELECT CONCAT(CONCAT(A,','),C),B
FROM R1;

REM DESPLIEGA AC-->B
SELECT DF_IZQ "AC-->B",DF_DER "D"
FROM TEMP_DF 
ORDER BY 1;

REM OBTIENE LA DF AD-->B
DELETE FROM TEMP_DF;

INSERT INTO TEMP_DF (DF_IZQ,DF_DER)
SELECT CONCAT(CONCAT(A,','),D),B
FROM R1;

PROMPT DESPLIEGA LA DF AD-->B

SELECT DF_IZQ "AD-->", DF_DER "B"
FROM TEMP_DF 
ORDER BY 1;

REM OBTENER ABC-->B
DELETE FROM TEMP_DF;

INSERT INTO TEMP_DF (DF_IZQ, DF_DER)
SELECT CONCAT(CONCAT(CONCAT(CONCAT(A,','),B),','),C),B
FROM R1;

SELECT DF_IZQ "ABC-->", DF_DER"B"
FROM TEMP_DF ORDER BY 1;

REM OBTIENE LA ABD-->B
DELETE FROM TEMP_DF;

INSERT INTO TEMP_DF (DF_IZQ, DF_DER)
SELECT CONCAT(CONCAT(CONCAT(CONCAT(A,','),B),','),D),B
FROM R1;

SELECT DF_IZQ "ABD-->", DF_DER"B"
FROM TEMP_DF ORDER BY 1;

REM SE OBTIENE ACD-->B
DELETE FROM TEMP_DF;

INSERT INTO TEMP_DF (DF_IZQ, DF_DER)
SELECT CONCAT(CONCAT(CONCAT(CONCAT(A,','),C),','),D),B
FROM R1;

SELECT DF_IZQ "ACD-->", DF_DER "B"
FROM TEMP_DF ORDER BY 1;

REM OBTIENES ABCD->B
DELETE FROM TEMP_DF;

INSERT INTO TEMP_DF (DF_IZQ, DF_DER)
SELECT CONCAT(
CONCAT(
CONCAT(
CONCAT(
CONCAT(
CONCAT(A,',')
,B),','),C),','),D),B
FROM R1;

SELECT DF_IZQ "ABCD-->", DF_DER "B"
FROM TEMP_DF 
ORDER BY 1;
spool off